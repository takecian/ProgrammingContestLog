# System design study

## システム設計を進め方

## システムの概要、要件をまとめる
* 誰が使うのか
* どのように使うのか
  * 想定ユーザーは何人くらいか
    * ユーザー認証をするか
  * 保存したいデータは何があるか
    * 読み書きの比率はどのくらいか
    * 秒間何リクエストくらい想定されるか 
  
* 概要から必要なデータ量、パフォーマンスを推測する
  * 保存するデータの１レコードあたりのサイズ
  * どれくらいの容量を捌く必要があるか
    * １レコードあたりのサイズ x 1日あたりのデータ数
    
## ハイレベルでのシステムデザインを作る
* どんなコンポーネントが存在するか
  * クライアント
  * ロードバランサー
  * Web サーバー(API サーバー)
  * DB
  * CDN
  * バッチサーバー
  
## 詳細設計
* コアになるデータベースのスキーマを決める
* データの生成方法など決める（ハッシュ化させるとか）

## スケール検討
* ボトルネックになりそうなところを割り出す
  * ロードバランサーが必要ではないか
  * 水平スケーリングする部分はないか
    * 台数並列に増やす
  * キャッシングした方がいい部分はないか
  * データベースシャーディングは必要か
    * シャーディングするとしたら何で分割するか
      * ユーザー単位、データ（テーブル）単位
        * データ単位だと結合が手間になるのでよく考えること

* データ量が増えるとシステム上困る部分は出てこないか
  * ハッシュを使うとすると衝突はどのくらいで起きるか
    * 起きた時どうするか

## 覚えておきたい
* Base64
  * 64文字（英数と+/=) で表す
  * 64文字だから 64=2**6 から 6bit 分を表すことができる
  * 6bit は半端なので、４文字分(3byte)をまとめて変換していく
  * 3byte が 4byte になるので 1.3倍長くはなる

## Ref.
* https://www.hiredintech.com
* https://github.com/donnemartin/system-design-primer/blob/master/README-ja.md

